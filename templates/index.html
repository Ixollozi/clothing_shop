{% extends "base.html" %}
{% load i18n %}
{% load humanize %}
{% load translation_tags %}

{% block title %}{{ store_title }}{% endblock %}

{% block content %}
    <!-- Hero Section -->
    <section class="hero" id="home" {% if hero_config.background_image %}style="background-image: url('{{ hero_config.background_image }}'); background-size: cover; background-position: center;"{% endif %}>
        <div class="hero-content">
            <h2 class="hero-title">{% if hero_config.title %}{{ hero_config.title }}{% else %}{% trans "Welcome to Our Store" %}{% endif %}</h2>
            <p class="hero-subtitle">{% if hero_config.subtitle %}{{ hero_config.subtitle }}{% else %}{% trans "Discover quality products" %}{% endif %}</p>
            <a href="{% url 'catalog' %}" class="btn btn-primary">{% if hero_config.button_text %}{{ hero_config.button_text }}{% else %}{% trans "View Catalog" %}{% endif %}</a>
        </div>
    </section>

    <!-- Categories -->
    {% if categories %}
    <section class="categories">
        <div class="container">
            <h2 class="section-title">{% trans "Categories" %}</h2>
            <div class="categories-grid">
                {% for category in categories %}
                <a href="{% url 'catalog' %}{% if category.slug %}?category={{ category.slug }}{% endif %}" style="text-decoration: none; color: inherit;">
                    <div class="category-card">
                        <div class="category-image">
                            {% if category.image %}
                                <img src="{{ category.image.url }}" alt="{{ category.name }}" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=400&fit=crop';">
                            {% elif category.image_url %}
                                <img src="{{ category.image_url }}" alt="{{ category.name }}" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=400&fit=crop';">
                            {% else %}
                                <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=400&fit=crop" alt="{{ category.name }}" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=400&h=400&fit=crop';">
                            {% endif %}
                        </div>
                        <h3>{{ category.name }}</h3>
                    </div>
                </a>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Products Section -->
    {% if products %}
    <section class="products" id="products">
        <div class="container">
            <h2 class="section-title">{% trans "Popular Products" %}</h2>
            <div class="products-grid">
                {% for product in products %}
                <div class="product-card">
                    <div class="product-image">
                        {% if product.slug %}
                            <a href="{% url 'product' product.slug %}">
                        {% else %}
                            <a href="{% url 'catalog' %}">
                        {% endif %}
                            {% if product.image %}
                                <img src="{{ product.image.url }}" alt="{{ product.name }}" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=400&fit=crop';">
                            {% elif product.image_url %}
                                <img src="{{ product.image_url }}" alt="{{ product.name }}" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=400&fit=crop';">
                            {% else %}
                                <img src="https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=400&h=400&fit=crop" alt="{{ product.name }}" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=400&fit=crop';">
                            {% endif %}
                        </a>
                        <div class="product-overlay">
                            {% if product.slug %}
                                <a href="{% url 'product' product.slug %}" class="btn btn-small">{% trans "Quick View" %}</a>
                            {% else %}
                                <a href="{% url 'catalog' %}" class="btn btn-small">{% trans "Quick View" %}</a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="product-info">
                        {% if product.slug %}
                            <a href="{% url 'product' product.slug %}" style="text-decoration: none; color: inherit;"><h3 class="product-name">{{ product.name }}</h3></a>
                        {% else %}
                            <a href="{% url 'catalog' %}" style="text-decoration: none; color: inherit;"><h3 class="product-name">{{ product.name }}</h3></a>
                        {% endif %}
                        <p class="product-price">
                            {{ product.price|format_price }} сум
                            {% if product.old_price and product.old_price > product.price %}
                                <span style="text-decoration: line-through; color: #999; font-size: 0.9em; margin-left: 10px;">{{ product.old_price|format_price }} сум</span>
                            {% endif %}
                        </p>
                        {% if product.id %}
                        <button class="btn btn-add-cart" data-product-id="{{ product.id }}" data-product-name="{{ product.name|escapejs }}">{% trans "Add to Cart" %}</button>
                        {% else %}
                        <button class="btn btn-add-cart" disabled>{% trans "Add to Cart" %}</button>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Features Section -->
    {% if features and features|length > 0 %}
    <section class="features">
        <div class="container">
            <div class="features-grid">
                {% for feature in features %}
                <div class="feature-item">
                    <i class="{{ feature.icon|default:'fas fa-star' }}"></i>
                    <h3>{{ feature.title|default:'Заголовок' }}</h3>
                    <p>{{ feature.description|default:'Описание' }}</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% else %}
    <section class="features">
        <div class="container">
            <div class="features-grid">
                <div class="feature-item">
                    <i class="fas fa-shipping-fast"></i>
                    <h3>{% trans "Fast Delivery" %}</h3>
                    <p>{% trans "Delivery throughout Uzbekistan in 2-5 days" %}</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-undo"></i>
                    <h3>{% trans "Easy Returns" %}</h3>
                    <p>{% trans "Product return within 14 days" %}</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-shield-alt"></i>
                    <h3>{% trans "Quality Guarantee" %}</h3>
                    <p>{% trans "Only original products" %}</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-headset"></i>
                    <h3>{% trans "24/7 Support" %}</h3>
                    <p>{% trans "Our support service is always available" %}</p>
                </div>
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Partners Section -->
    {% if partners %}
    <section class="partners">
        <div class="container">
            <h2 class="section-title">{% trans "Our Partners" %}</h2>
            <p class="partners-subtitle">{% trans "We cooperate with leading brands and suppliers" %}</p>
            <div class="partners-grid">
                {% for partner in partners %}
                <div class="partner-item">
                    {% if partner.url %}
                        <a href="{{ partner.url }}" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit; display: block;">
                    {% endif %}
                    <div class="partner-logo">
                        {% if partner.logo %}
                            <img src="{{ partner.logo.url }}" alt="{{ partner.name }}" style="max-width: 100px; max-height: 100px;">
                        {% else %}
                            <i class="{{ partner.icon }}"></i>
                        {% endif %}
                        <h4>{{ partner.name }}</h4>
                        {% if partner.description %}
                            <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">{{ partner.description }}</p>
                        {% endif %}
                    </div>
                    {% if partner.url %}
                        </a>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}
{% endblock %}

{% block extra_js %}
{% endblock %}
